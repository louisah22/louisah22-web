<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>Ice Cream Stores</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.css' rel='stylesheet' />
<style>
body { margin:0; padding:0; }
#map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>


<style>
  .mapboxgl-popup {
  max-width: 280px;
  font: 13px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  }
</style>


<div id='map'></div>
<div class='map-overlay' id='features'><h2>Ice Cream Stores Along Bus #14 from UBC</h2></div>
<style>
  body {
    margin: 0;
    padding: 0;
  }

  h2,
  h3 {
    margin: 15px;
    font-size: 1.3em;
  }

  h3 {
    font-size: 1.1em;
  }

  p {
    font-size: 1.1em;
    margin: 10px;
    text-align: left;
  }

  #map {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100%;
  }

  .map-overlay {
    position: absolute;
    bottom: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.8);
    margin-right: 1150px;
    font-family: Arial, sans-serif;
    overflow: auto;
    border-radius: 3px;
  }

  #features {
    top: 0;
    height: 85px;
    margin-top: 20px;
    width: 270px;
  }
</style>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoibG91aXNhaDIyIiwiYSI6ImNqcjQ5Z3F3aDAxbWY0NW8yaG5pZ2ZjbzMifQ.UvIJ1RCjTlZvV35u4_1qnw';

var map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/louisah22/cjrissuda5cgu2sntmeonowdf',
center: [-123.14, 49.2555],
zoom: 11.5
});



map.on('load', function () {
    // Add a layer showing the places.
    map.loadImage('https://upload.wikimedia.org/wikipedia/commons/8/84/Sorvete.png', function(error, image) {
        if (error) throw error;
    map.addImage('ice_cream', image);
    map.addLayer({
        "id": "points",
        "type": "symbol",
        "source": {
            "type": "geojson",
            "data": {
                "type": "FeatureCollection",
                "features": [{
                    "type": "Feature",
                    "properties": {
                        "description": "<strong>Rain or Shine</strong><p>Cool hangout with creative flavours of ice cream. Take the 14 and get off at Stop ID 50323.</p>",
                        "icon": "ice_cream"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.1487, 49.2679]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "<strong>Paradiso Italian Gelato</strong><p>Head here for a light frozen treat. Take the 14 and get off at Stop ID 50322.</p>",
                        "icon": "ice_cream"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.1548, 49.2722]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "<strong>Tangram Creamery</strong><p>Rustic environment with homemade ice cream. Take the 14 and get off at Stop ID 50323.</p>",
                        "icon": "ice_cream"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.1533, 49.2616]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "<strong>La Glace</strong><p>Rich and decadent ice cream made with natural and local ingredients when possible. Take the 14 and get off at Stop ID 50320.</p>",
                        "icon": "ice_cream"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.1680, 49.2579]
                      }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "<strong>720 Sweets & Etc.</strong><p>Visit for a unique twist on the traditional dessert. Take the 14 and get off at Stop ID 60725.</p>",
                        "icon": "ice_cream"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.1772, 49.2640]
                    }
                  }, {
                      "type": "Feature",
                      "properties": {
                          "description": "<strong>Yaletown Gelato</strong><p>A cozy environment serving up Italian ice cream. Take the 14 and get off at Stop ID 50220.</p>",
                          "icon": "ice_cream"
                      },
                      "geometry": {
                          "type": "Point",
                          "coordinates": [-123.1234, 49.2750]
                      }
                    }, {
                        "type": "Feature",
                        "properties": {
                            "description": "<strong>Mister Artisan Ice Cream</strong><p>Making dense and rich ice cream with liquid nitrogen. Take the 14 and get off at Stop ID 50220.</p>",
                            "icon": "ice_cream"
                        },
                        "geometry": {
                            "type": "Point",
                            "coordinates": [-123.1217, 49.2752]
                        }
                      }, {
                          "type": "Feature",
                          "properties": {
                              "description": "<strong>Gelato Express</strong><p>Come here to try a wide variety of flavours, including the Cookie Monster! Take the 14 and get off at Stop ID 58144.</p>",
                              "icon": "ice_cream"
                          },
                          "geometry": {
                              "type": "Point",
                              "coordinates": [-123.1164, 49.2789]
                          }
                      }, {
                          "type": "Feature",
                          "properties": {
                              "description": "<strong>Bella Gelateria</strong><p>Gelato made in-house. Provides options for those who are lactose intolerant, vegan, or have allergies. Take the 14 and get off at Stop ID 58313.</p>",
                              "icon": "ice_cream"
                          },
                          "geometry": {
                              "type": "Point",
                              "coordinates": [-123.1164, 49.2879]
                          }
                      }, {
                          "type": "Feature",
                          "properties": {
                              "description": "<strong>Soft Peaks</strong><p>Uses organic milk and locally-sourced toppings. Take the 14 and get off at Stop ID 50933.</p>",
                              "icon": "ice_cream"
                          },
                          "geometry": {
                              "type": "Point",
                              "coordinates": [-123.1037, 49.2836]
                          }
                        }, {
                            "type": "Feature",
                            "properties": {
                                "description": "<strong>Brown Paper Packages Ice Cream</strong><p>A quarky ice cream joint for everyone. Take the 14 and get off at Stop ID 50933.</p>",
                                "icon": "ice_cream"
                            },
                            "geometry": {
                                "type": "Point",
                                "coordinates": [-123.1019, 49.2791]
                            }
                          }, {
                              "type": "Feature",
                              "properties": {
                                  "description": "<strong>Umaluma Dairy-Free Gelato</strong><p>A good place to lounge that provides plant-based dairy-free gelato. Take the 14 and get off at Stop ID 50935.</p>",
                                  "icon": "ice_cream"
                              },
                              "geometry": {
                                  "type": "Point",
                                  "coordinates": [-123.0987, 49.2806]
                              }
                            }, {
                                "type": "Feature",
                                "properties": {
                                    "description": "<strong>La Casa Gelato</strong><p>Served the Lower Mainland for over 34 years and carries 238 flavours. Take the 14 and get off at Stop ID 50939.</p>",
                                    "icon": "ice_cream"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [-123.0816, 49.2771]
                                }
                            }, {
                                "type": "Feature",
                                "properties": {
                                    "description": "<strong>Uno Gelato</strong><p>Flavours of true artisan gelato made by one of the world's best, James Coleridge. Take the 14 and get off at Stop ID 50320.</p>",
                                    "icon": "ice_cream"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [-123.1642, 49.2642]
                                }
              }]
            }
        },
        "layout": {
            "icon-image": "ice_cream",
            "icon-size": 0.2
        }
      });
});

    // When a click event occurs on a feature in the places layer, open a popup at the
    // location of the feature, with description HTML from its properties.
    map.on('click', 'points', function (e) {
        var coordinates = e.features[0].geometry.coordinates.slice();
        var description = e.features[0].properties.description;

        // Ensure that if the map is zoomed out such that multiple
        // copies of the feature are visible, the popup appears
        // over the copy being pointed to.
        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
        }

        new mapboxgl.Popup()
            .setLngLat(coordinates)
            .setHTML(description)
            .addTo(map);
    });

    // Change the cursor to a pointer when the mouse is over the places layer.
    map.on('mouseenter', 'points', function () {
        map.getCanvas().style.cursor = 'pointer';
    });

    // Change it back to a pointer when it leaves.
    map.on('mouseleave', 'points', function () {
        map.getCanvas().style.cursor = '';
    });
});

map.on('load', function() {
map.setPaintProperty('building', 'fill-color', [
"interpolate",
  ["exponential", 0.5],
  ["zoom"],
    0,
      "#e9e9e7",
    16,
      "#eae8d3",
    17.5,
      "#e8e6c9"
]);

map.setPaintProperty('building', 'fill-opacity', [
"interpolate",
  ["exponential", 0.5],
  ["zoom"],
      15,
      0,
      22,
      1
    ]);
});

document.getElementById('zoom').addEventListener('click', function () {
map.zoomTo(19, {duration: 9000});
});
</script>

<script>
map.on('load', function() {
    map.addLayer({
      id: '14_route',
      type: 'line',
        source: {
          type: 'vector',
          url: 'mapbox://louisah22.cjriomg790mvz2wqr2n9sh7tq-1na8c'
        },
    'source-layer':'14_route',
    paint: {
      'line-color': '#ed6d3b',
      'line-width': 3,
      }
    });
});

map.on('load', function () {
    // Add a layer showing the places.
    map.addLayer({
        "id": "stops",
        "type": "symbol",
        "source": {
            "type": "geojson",
            "data": {
                "type": "FeatureCollection",
                "features": [{
                    "type": "Feature",
                    "properties": {
                        "description": "Stop ID 50322 (Eastbound W Broadway @ Vine St)",
                        "icon": "dot-9"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.15716, 49.2639]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "Stop ID 50320 (Eastbound W Broadway @ Trafalgar St)",
                        "icon": "dot-9"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.164293, 49.264]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "Stop ID 60725 (Eastbound W Broadway @ Collingwood St)",
                        "icon": "dot-9"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-123.181425, 49.264214]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": "Stop ID 50323 (Eastbound W Broadway @ Arbutus St)",
                        "icon": "dot-9"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [ -123.153281, 49.263761]
                      }
              }, {
                  "type": "Feature",
                  "properties": {
                      "description": "Stop ID 50220 (Northbound Granville St @ Davie St)",
                      "icon": "dot-9"
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [-123.125349, 49.277627]
                }
              }, {
                  "type": "Feature",
                  "properties": {
                      "description": "Stop ID 58144 (Northbound Granville St @ Smithe St)",
                      "icon": "dot-9"
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [-123.120572, 49.280864]
                }
              }, {
                  "type": "Feature",
                  "properties": {
                      "description": "Stop ID 58313 (Northbound Granville St @ W Pender St)",
                      "icon": "dot-9"
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [-123.115007, 49.284551]
                }
              }, {
                  "type": "Feature",
                  "properties": {
                      "description": "Stop ID 50933 (Eastbound E Hastings St @ Carrall St)",
                      "icon": "dot-9"
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [-123.103445, 49.281360]
                }
              }, {
                  "type": "Feature",
                  "properties": {
                      "description": "Stop ID 50935 (Eastbound E Hastings St @ Gore Ave)",
                      "icon": "dot-9"
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [-123.096762, 49.281198]
                }
              }, {
                  "type": "Feature",
                  "properties": {
                      "description": "Stop ID 50939 (Eastbound E Hastings St @ Campbell Ave)",
                      "icon": "dot-9"
                  },
                  "geometry": {
                      "type": "Point",
                      "coordinates": [-123.084229, 49.280966]
                }
              }
              ]
            }
        },
        "layout": {
            "icon-image": "dot-9",
            "icon-size": 2,
            "icon-allow-overlap": true,
        }
      });
});

// Create a popup, but don't add it to the map yet.
var popup = new mapboxgl.Popup({
closeButton: false,
closeOnClick: false
});

map.on('mouseenter', 'stops', function(e) {
// Change the cursor style as a UI indicator.
map.getCanvas().style.cursor = 'pointer';

var coordinates = e.features[0].geometry.coordinates.slice();
var description = e.features[0].properties.description;

// Ensure that if the map is zoomed out such that multiple
// copies of the feature are visible, the popup appears
// over the copy being pointed to.
while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
}

// Populate the popup and set its coordinates
// based on the feature found.
popup.setLngLat(coordinates)
.setHTML(description)
.addTo(map);
});

map.on('mouseleave', 'stops', function() {
map.getCanvas().style.cursor = '';
popup.remove();
});

map.addControl(new mapboxgl.NavigationControl({ position: 'top-left' }));

</script>

</body>
</html>
